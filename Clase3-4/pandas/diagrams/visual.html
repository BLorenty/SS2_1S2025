<!DOCTYPE html>
<html>
<head>
    <title>Visor de Diagramas Mermaid</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
</head>
<body>
    <div class="mermaid">
        flowchart TD
        subgraph DataOriginal["DataFrame Original"]
            A["df[Pilot Name]
            Juan Pérez
            María García
            Juan Pérez
            Pedro López
            María García"]
        end
    
        subgraph DimensionPilot["Crear DimPilot"]
            B["1. drop_duplicates()
            Juan Pérez
            María García
            Pedro López"] --> 
            C["2. Asignar PilotID
            PilotID | Pilot Name
            1       | Juan Pérez
            2       | María García
            3       | Pedro López"]
        end
    
        subgraph CrearMapeo["Crear Mapeo"]
            D["3. set_index('Pilot Name')
            Índice    | PilotID
            Juan Pérez    | 1
            María García  | 2
            Pedro López   | 3"] -->
            E["4. map()
            Busca cada 'Pilot Name' 
            y asigna su PilotID"]
        end
    
        subgraph ResultadoFinal["Resultado Final"]
            F["df[PilotID]
            1
            2
            1
            3
            2"]
        end
    
        A --> B
        C --> D
        E --> F
    
        style DataOriginal fill:#f9f9f9,stroke:#333,stroke-width:2px
        style DimensionPilot fill:#e6f3ff,stroke:#333,stroke-width:2px
        style CrearMapeo fill:#fff2e6,stroke:#333,stroke-width:2px
        style ResultadoFinal fill:#e6ffe6,stroke:#333,stroke-width:2px
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose'
        });
    </script>
</body>
</html>
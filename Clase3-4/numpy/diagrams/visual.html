<!DOCTYPE html>
<html>
<head>
    <title>Visor de Diagramas Mermaid</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.6.1/mermaid.min.js"></script>
</head>
<body>
    <div class="mermaid">
        flowchart TD
        subgraph ArrayOriginal["Array Original NumPy"]
            A["data[:, col_pilot_name]
            Juan Pérez
            María García
            Juan Pérez
            Pedro López
            María García"]
        end
    
        subgraph CrearDimension["Crear Dimensión"]
            B["1. np.unique
            Juan Pérez
            María García
            Pedro López"] --> 
            C["2. np.arange para IDs
            PilotID | Pilot Name
            1       | Juan Pérez
            2       | María García
            3       | Pedro López"]
        end
    
        subgraph CrearMapeo["Crear Diccionario de Mapeo"]
            D["3. Crear diccionario
            pilot_id_map = {
                'Juan Pérez': 1,
                'María García': 2,
                'Pedro López': 3
            }"] -->
            E["4. Aplicar mapeo en bucle
            para crear FactFlight"]
        end
    
        subgraph ResultadoFinal["Array Final"]
            F["fact_flight columna PilotID
            1
            2
            1
            3
            2"]
        end
    
        A --> B
        C --> D
        E --> F
    
        style ArrayOriginal fill:#f9f9f9,stroke:#333,stroke-width:2px
        style CrearDimension fill:#e6f3ff,stroke:#333,stroke-width:2px
        style CrearMapeo fill:#fff2e6,stroke:#333,stroke-width:2px
        style ResultadoFinal fill:#e6ffe6,stroke:#333,stroke-width:2px
    </div>

    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose'
        });
    </script>
</body>
</html>